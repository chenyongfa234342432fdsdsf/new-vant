import {
  getCssBaseFile
} from "./chunk-67CKMM2A.js";
import {
  normalizePath,
  smartOutputFile
} from "./chunk-PLIM7P7F.js";
import {
  context_default
} from "./chunk-WOQRSCMF.js";
import {
  STYLE_DEPS_JSON_FILE
} from "./chunk-D3YCLLHO.js";

// src/compiler/gen-package-style.ts
import path from "path";
import slash from "slash2";
import fse from "fs-extra";
import { createRequire } from "module";
var { existsSync } = fse;
function genPackageStyle(options) {
  const require2 = createRequire(import.meta.url);
  const styleDepsJson = require2(STYLE_DEPS_JSON_FILE);
  let content = "";
  let baseFile = getCssBaseFile();
  if (baseFile) {
    if (options.pathResolver) {
      baseFile = options.pathResolver(baseFile);
    }
    content += `@import "${normalizePath(baseFile)}";
`;
  }
  content += styleDepsJson.sequence.map((componentFilePath) => {
    var _a, _b;
    let stylePath = path.join(componentFilePath, "..", (_b = (_a = context_default.opts) == null ? void 0 : _a.build) == null ? void 0 : _b.style);
    if (!existsSync(stylePath)) {
      return "";
    }
    if (options.pathResolver) {
      stylePath = options.pathResolver(stylePath);
    }
    return `@import "${normalizePath(stylePath)}";`;
  }).filter((item) => !!item).join("\n");
  smartOutputFile(options.outputPath, slash(content));
}

export {
  genPackageStyle
};
