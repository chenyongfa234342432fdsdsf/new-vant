import {
  setNodeEnv
} from "./chunk-PLIM7P7F.js";
import {
  JEST_CONFIG_FILE,
  ROOT
} from "./chunk-D3YCLLHO.js";

// src/commands/jest.ts
import jest from "jest";
function test(command) {
  setNodeEnv("test");
  const config = {
    rootDir: ROOT,
    watch: command.watch,
    debug: command.debug,
    config: JEST_CONFIG_FILE,
    runInBand: command.runInBand,
    clearCache: command.clearCache,
    changedSince: command.changedSince,
    logHeapUsage: command.logHeapUsage,
    updateSnapshot: command.updateSnapshot,
    maxWorkers: "50%"
  };
  jest.runCLI(config, [ROOT]).then((response) => {
    if (!response.results.success && !command.watch) {
      process.exit(1);
    }
  }).catch((err) => {
    console.log(err);
    if (!command.watch) {
      process.exit(1);
    }
  });
}

export {
  test
};
